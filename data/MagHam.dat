MagHam[{Bx_, By_, Bz_}, {\[Theta]z1_, \[Theta]y_, \[Theta]z2_}, 1] := 
    With[{c = Cos[\[Theta]y], s = Sin[\[Theta]y], c1 = Cos[\[Theta]z1], 
      s1 = Sin[\[Theta]z1], c2 = Cos[\[Theta]z2], 
      s2 = Sin[\[Theta]z2]}, {{2870. + 2.802495266*Bz*c + 
        2.802495266*Bx*c2*s + 2.802495266*By*s*s2, 1.9816634068317975*
        (1.*c1 + (0. + 1.*I)*s1)*((0. - 1.*I)*By*c2 + 1.*Bx*c*c2 - 1.*Bz*s + 
         (0. + 1.*I)*Bx*s2 + 1.*By*c*s2), 0}, 
      {1.9816634068317975*(1.*c1 - (0. + 1.*I)*s1)*((0. + 1.*I)*By*c2 + 
         1.*Bx*c*c2 - 1.*Bz*s - (0. + 1.*I)*Bx*s2 + 1.*By*c*s2), 0, 
       1.9816634068317975*(1.*c1 + (0. + 1.*I)*s1)*((0. - 1.*I)*By*c2 + 
         1.*Bx*c*c2 - 1.*Bz*s + (0. + 1.*I)*Bx*s2 + 1.*By*c*s2)}, 
      {0, 1.9816634068317975*(1.*c1 - (0. + 1.*I)*s1)*((0. + 1.*I)*By*c2 + 
         1.*Bx*c*c2 - 1.*Bz*s - (0. + 1.*I)*Bx*s2 + 1.*By*c*s2), 
       2870. - 2.802495266*Bz*c - 2.802495266*Bx*c2*s - 2.802495266*By*s*s2}}]
 
MagHam[{Bx_, By_, Bz_}, {\[Theta]z1_, \[Theta]y_, \[Theta]z2_}, 2] := 
    With[{c = Cos[\[Theta]y], s = Sin[\[Theta]y], c1 = Cos[\[Theta]z1], 
      s1 = Sin[\[Theta]z1], c2 = Cos[\[Theta]z2], 
      s2 = Sin[\[Theta]z2]}, {{2870. - 0.9341650886666667*Bz*c + 
        2.64221787577573*Bx*c*c1*c2 - 2.64221787577573*Bz*c1*s - 
        0.9341650886666667*Bx*c2*s + 2.64221787577573*By*c2*s1 + 
        2.64221787577573*By*c*c1*s2 - 0.9341650886666667*By*s*s2 - 
        2.64221787577573*Bx*s1*s2, -0.6605544689439325*
        (2.8284271247461903*Bx*c2*s + By*c2*s1 + (0. + 3.*I)*Bz*s*s1 + 
         2.8284271247461903*By*s*s2 - 1.*Bx*s1*s2 + 
         c1*((0. + 3.*I)*By*c2 - 1.*Bz*s - (0. + 3.*I)*Bx*s2) + 
         c*(2.8284271247461903*Bz + (c1 - (0. + 3.*I)*s1)*(Bx*c2 + By*s2))), 
       0}, {-0.6605544689439325*(2.8284271247461903*Bx*c2*s + By*c2*s1 - 
         (0. + 3.*I)*Bz*s*s1 + 2.8284271247461903*By*s*s2 - 1.*Bx*s1*s2 + 
         c1*((0. - 3.*I)*By*c2 - 1.*Bz*s + (0. + 3.*I)*Bx*s2) + 
         c*(2.8284271247461903*Bz + (c1 + (0. + 3.*I)*s1)*(Bx*c2 + By*s2))), 
       0, -0.6605544689439325*(2.8284271247461903*Bx*c2*s + By*c2*s1 + 
         (0. + 3.*I)*Bz*s*s1 + 2.8284271247461903*By*s*s2 - 1.*Bx*s1*s2 + 
         c1*((0. + 3.*I)*By*c2 - 1.*Bz*s - (0. + 3.*I)*Bx*s2) + 
         c*(2.8284271247461903*Bz + (c1 - (0. + 3.*I)*s1)*(Bx*c2 + By*s2)))}, 
      {0, -0.6605544689439325*(2.8284271247461903*Bx*c2*s + By*c2*s1 - 
         (0. + 3.*I)*Bz*s*s1 + 2.8284271247461903*By*s*s2 - 1.*Bx*s1*s2 + 
         c1*((0. - 3.*I)*By*c2 - 1.*Bz*s + (0. + 3.*I)*Bx*s2) + 
         c*(2.8284271247461903*Bz + (c1 + (0. + 3.*I)*s1)*(Bx*c2 + By*s2))), 
       2870. + 0.9341650886666667*Bz*c - 2.64221787577573*Bx*c*c1*c2 + 
        2.64221787577573*Bz*c1*s + 0.9341650886666667*Bx*c2*s - 
        2.64221787577573*By*c2*s1 - 2.64221787577573*By*c*c1*s2 + 
        0.9341650886666667*By*s*s2 + 2.64221787577573*Bx*s1*s2}}]
 
MagHam[{Bx_, By_, Bz_}, {\[Theta]z1_, \[Theta]y_, \[Theta]z2_}, 3] := 
    With[{c = Cos[\[Theta]y], s = Sin[\[Theta]y], c1 = Cos[\[Theta]z1], 
      s1 = Sin[\[Theta]z1], c2 = Cos[\[Theta]z2], 
      s2 = Sin[\[Theta]z2]}, {{2870. - 1.321108937887865*Bx*c*c1*c2 - 
        0.9341650886666667*Bx*c2*s - 2.2882278027551384*Bx*c*c2*s1 + 
        Bz*(-0.9341650886666667*c + 1.321108937887865*c1*s + 
          2.2882278027551384*s*s1) - 2.2882278027551384*Bx*c1*s2 + 
        1.321108937887865*Bx*s1*s2 + By*(2.2882278027551384*c1*c2 - 
          1.321108937887865*c2*s1 - 1.321108937887865*c*c1*s2 - 
          0.9341650886666667*s*s2 - 2.2882278027551384*c*s1*s2), 
       Bz*(-1.8683301773333338*c - (0.3302772344719663 + 1.716170852066354*I)*
           c1*s - (0.5720569506887846 - 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 + 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s + (0.5720569506887846 - 0.9908317034158988*
             I)*c*c2*s1 + (0.5720569506887846 - 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 + 1.716170852066354*I)*s1*s2) + 
        By*((-0.5720569506887846 + 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 + 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 + 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 + (0.5720569506887846 - 0.9908317034158988*
             I)*c*s1*s2), 0}, 
      {Bz*(-1.8683301773333338*c - (0.3302772344719663 - 1.716170852066354*I)*
           c1*s - (0.5720569506887846 + 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 - 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s + (0.5720569506887846 + 0.9908317034158988*
             I)*c*c2*s1 + (0.5720569506887846 + 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 - 1.716170852066354*I)*s1*s2) + 
        By*((-0.5720569506887846 - 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 - 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 - 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 + (0.5720569506887846 + 0.9908317034158988*
             I)*c*s1*s2), 0, Bz*(-1.8683301773333338*c - 
          (0.3302772344719663 + 1.716170852066354*I)*c1*s - 
          (0.5720569506887846 - 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 + 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s + (0.5720569506887846 - 0.9908317034158988*
             I)*c*c2*s1 + (0.5720569506887846 - 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 + 1.716170852066354*I)*s1*s2) + 
        By*((-0.5720569506887846 + 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 + 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 + 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 + (0.5720569506887846 - 0.9908317034158988*
             I)*c*s1*s2)}, {0, Bz*(-1.8683301773333338*c - 
          (0.3302772344719663 - 1.716170852066354*I)*c1*s - 
          (0.5720569506887846 + 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 - 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s + (0.5720569506887846 + 0.9908317034158988*
             I)*c*c2*s1 + (0.5720569506887846 + 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 - 1.716170852066354*I)*s1*s2) + 
        By*((-0.5720569506887846 - 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 - 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 - 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 + (0.5720569506887846 + 0.9908317034158988*
             I)*c*s1*s2), 2870. + 1.321108937887865*Bx*c*c1*c2 + 
        0.9341650886666667*Bx*c2*s + 2.2882278027551384*Bx*c*c2*s1 + 
        Bz*(0.9341650886666667*c - 1.321108937887865*c1*s - 
          2.2882278027551384*s*s1) + 2.2882278027551384*Bx*c1*s2 - 
        1.321108937887865*Bx*s1*s2 + By*(-2.2882278027551384*c1*c2 + 
          1.321108937887865*c2*s1 + 1.321108937887865*c*c1*s2 + 
          0.9341650886666667*s*s2 + 2.2882278027551384*c*s1*s2)}}]
 
MagHam[{Bx_, By_, Bz_}, {\[Theta]z1_, \[Theta]y_, \[Theta]z2_}, 4] := 
    With[{c = Cos[\[Theta]y], s = Sin[\[Theta]y], c1 = Cos[\[Theta]z1], 
      s1 = Sin[\[Theta]z1], c2 = Cos[\[Theta]z2], 
      s2 = Sin[\[Theta]z2]}, {{2870. - 1.321108937887865*Bx*c*c1*c2 - 
        0.9341650886666667*Bx*c2*s + 2.2882278027551384*Bx*c*c2*s1 + 
        Bz*(-0.9341650886666667*c + 1.321108937887865*c1*s - 
          2.2882278027551384*s*s1) + 2.2882278027551384*Bx*c1*s2 + 
        1.321108937887865*Bx*s1*s2 + By*(-2.2882278027551384*c1*c2 - 
          1.321108937887865*c2*s1 - 1.321108937887865*c*c1*s2 - 
          0.9341650886666667*s*s2 + 2.2882278027551384*c*s1*s2), 
       Bz*(-1.8683301773333338*c - (0.3302772344719663 - 1.716170852066354*I)*
           c1*s + (0.5720569506887846 + 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 - 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s - (0.5720569506887846 + 0.9908317034158988*
             I)*c*c2*s1 - (0.5720569506887846 + 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 - 1.716170852066354*I)*s1*s2) + 
        By*((0.5720569506887846 + 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 - 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 - 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 - (0.5720569506887846 + 0.9908317034158988*
             I)*c*s1*s2), 0}, 
      {Bz*(-1.8683301773333338*c - (0.3302772344719663 + 1.716170852066354*I)*
           c1*s + (0.5720569506887846 - 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 + 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s - (0.5720569506887846 - 0.9908317034158988*
             I)*c*c2*s1 - (0.5720569506887846 - 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 + 1.716170852066354*I)*s1*s2) + 
        By*((0.5720569506887846 - 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 + 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 + 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 - (0.5720569506887846 - 0.9908317034158988*
             I)*c*s1*s2), 0, Bz*(-1.8683301773333338*c - 
          (0.3302772344719663 - 1.716170852066354*I)*c1*s + 
          (0.5720569506887846 + 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 - 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s - (0.5720569506887846 + 0.9908317034158988*
             I)*c*c2*s1 - (0.5720569506887846 + 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 - 1.716170852066354*I)*s1*s2) + 
        By*((0.5720569506887846 + 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 - 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 - 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 - (0.5720569506887846 + 0.9908317034158988*
             I)*c*s1*s2)}, {0, Bz*(-1.8683301773333338*c - 
          (0.3302772344719663 + 1.716170852066354*I)*c1*s + 
          (0.5720569506887846 - 0.9908317034158988*I)*s*s1) + 
        Bx*((0.3302772344719663 + 1.716170852066354*I)*c*c1*c2 - 
          1.8683301773333338*c2*s - (0.5720569506887846 - 0.9908317034158988*
             I)*c*c2*s1 - (0.5720569506887846 - 0.9908317034158988*I)*c1*s2 - 
          (0.3302772344719663 + 1.716170852066354*I)*s1*s2) + 
        By*((0.5720569506887846 - 0.9908317034158988*I)*c1*c2 + 
          (0.3302772344719663 + 1.716170852066354*I)*c2*s1 + 
          (0.3302772344719663 + 1.716170852066354*I)*c*c1*s2 - 
          1.8683301773333338*s*s2 - (0.5720569506887846 - 0.9908317034158988*
             I)*c*s1*s2), 2870. + 1.321108937887865*Bx*c*c1*c2 + 
        0.9341650886666667*Bx*c2*s - 2.2882278027551384*Bx*c*c2*s1 + 
        Bz*(0.9341650886666667*c - 1.321108937887865*c1*s + 
          2.2882278027551384*s*s1) - 2.2882278027551384*Bx*c1*s2 - 
        1.321108937887865*Bx*s1*s2 + By*(2.2882278027551384*c1*c2 + 
          1.321108937887865*c2*s1 + 1.321108937887865*c*c1*s2 + 
          0.9341650886666667*s*s2 - 2.2882278027551384*c*s1*s2)}}]
 
Attributes[Bx] = {Temporary}
 
Attributes[By] = {Temporary}
 
Attributes[Bz] = {Temporary}
 
Attributes[\[Theta]z1] = {Temporary}
 
Attributes[\[Theta]y] = {Temporary}
 
Attributes[\[Theta]z2] = {Temporary}
 
Attributes[c] = {Temporary}
 
Attributes[s] = {Temporary}
 
Attributes[c1] = {Temporary}
 
Attributes[s1] = {Temporary}
 
Attributes[c2] = {Temporary}
 
Attributes[s2] = {Temporary}
